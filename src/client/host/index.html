<!DOCTYPE html>
<html>
<head>
	<title>Minna Tōhyō</title>
</head>
<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript">
    const socket = io('/host');
    let player = {id: 'not-connected'};
    socket.on('connect', () => {
        socket.emit('auto-assign');
        socket.on('auto-assign-complete', isPlayer => {
            if (isPlayer) {
                const e = document.getElementById('hostButton');
                e.parentNode.removeChild(e);
                document.getElementById('connect-text').innerHTML = 'Connected, however there is already someone hosting...';
            } else document.getElementById('connect-text').innerHTML = `Connected. You are the host.`;
        });

        socket.on('players-update', players => {
            const humanList = [];
            for (let i = 0; i < players.length; i++) humanList.push(`${players[i].nickname} - ${players[i].id}`);
            document.getElementById('user-list').innerHTML = `Connected users:<br>${humanList.join('<br>')}`;
        });

        socket.on('game-start', gameInfo => {
            document.getElementById('connect-text').innerHTML = "Received game-start signal. Starting the game now...";
        });
    });
</script>
<script src="joinHandler.js"></script>
<body>
    <div id="user-controls">
            <h1 id="connect-text">Connecting...</h1>
            <p id="name-text">Enter your nickname:</p><br>
            <form>
                <input type="text" id="nickname"><br>
                <input type="file" id="gameJsonFilePicker" style="display: none;"><br>
            </form>
            <button id="hostButton" onclick="sendPacketHost(socket)">Host</button> 
            <p id="user-list">No connected players</p>
            <button id="gameStartButton" onclick="sendPacketGameStart(socket)" style="display: none;">Start Game</button> 
    </div>
</body>
</html>
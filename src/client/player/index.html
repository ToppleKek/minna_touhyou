<!DOCTYPE html>
<html>
<head>
	<title>Minna Tōhyō</title>
</head>
<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript">
    const socket = io();
    let player = {id: 'not-connected'};
    socket.on('connect', () => {
        socket.emit('auto-assign');
        socket.on('auto-assign-complete', isPlayer => {
            if (isPlayer) {
                const e = document.getElementById('hostButton');
                e.parentNode.removeChild(e);
                document.getElementById('connect-text').innerHTML = 'Connected. You have been selected as a player.';
            } else document.getElementById('connect-text').innerHTML = `Connected. Select playing type:`;
        });

        socket.on('players-update', players => {
            const humanList = [];
            for (let i = 0; i < players.length; i++) humanList.push(`${players[i].nickname} - ${players[i].id}`);
            document.getElementById('user-list').innerHTML = `Connected users:<br>${humanList.join('<br>')}`;
        });


    });
</script>
<script src="joinHandler.js"></script>
<body>
    <div id="user-controls">
            <h1 id="connect-text">Connecting...</h1>
            <p id="name-text">Enter your nickname:</p><br>
            <form>
                <input type="text" id="nickname"><br>
            </form>
            <button id="hostButton" onclick="window.location.href = `${window.location.href}/host`;">Host</button>
            <button id="playerButton" onclick="sendPacketPlayer(socket, player)">Play</button>      
            <p id="user-list">No connected players</p>  
    </div>
</body>
</html>